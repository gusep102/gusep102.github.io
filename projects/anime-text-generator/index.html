<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>GPT-2 Based Chatbot</title>

  

  <meta name="description" content="Utilizing GPT-2 to create a chatbot like program.">

  

  

  <link rel="alternate" type="application/rss+xml" title="Gus Peralta" href="https://gusperalta.com/feed.xml">

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Gus Peralta">
  <meta property="og:title" content="GPT-2 Based Chatbot">
  <meta property="og:description" content="Utilizing GPT-2 to create a chatbot like program.">

  
  <meta property="og:image" content="https://gusperalta.com/assets/img/avatar.jpg">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="">
  <meta property="og:article:published_time" content="2021-03-09T04:02:38-05:00">
  <meta property="og:url" content="https://gusperalta.com/projects/anime-text-generator/">
  <link rel="canonical" href="https://gusperalta.com/projects/anime-text-generator/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta property="twitter:title" content="GPT-2 Based Chatbot">
  <meta property="twitter:description" content="Utilizing GPT-2 to create a chatbot like program.">

  
  <meta name="twitter:image" content="https://gusperalta.com/assets/img/avatar.jpg">
  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-md navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="https://gusperalta.com/">Gus Peralta</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/projects">Projects</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/about">About</a>
          </li></ul>
  </div>

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="https://gusperalta.com/">
          <img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/avatar.jpg" />
        </a>
      </div>
    </div>
  

</nav>


  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="page-heading">
          <h1>GPT-2 Based Chatbot</h1>
          
            
              <hr class="small">
              <span class="page-subheading">Utilizing GPT-2 to create a chatbot like program.</span>
            
          

          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md " role="main">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">
      

      <p>Utilizing OpenAI’s GPT-2 language model along with a dataset abstracted from anime subtitles, a GPT-2 model was created to generate text which takes influence from typical anime scripts. The program allows the user to input a string of text for the GPT-2 Model to base the text on. With this setup the program has been modified to act as a chatbot.
<!--more--></p>

<h3 id="why-utilize-gpt-2">Why Utilize GPT-2</h3>

<p>GPT-2 has the ability to generate believable text based on the datasets it was fed. Because of this I chose GPT-2 as a way to generate anime scripts that can be believable.</p>

<p>Below I will give an overview of how the program works. It is not really meant as a tutorial. If you would just like to see examples of my program running and the outputs it gave after being trained with anime subtitles click <a href="#personal-examples">here</a></p>

<h3 id="the-setup">The Setup</h3>
<p>We are going to utilize a pre-made github repo which was made to make it easier for people to train GPT-2 model with text files. This allows for easier and faster experimentation.</p>

<p>First cloning <a href="https://github.com/nshepperd/gpt-2">nshepperd’s</a> repo to the location we would like to work from. After this we make sure python is installed correctly with all the modules. running the terminal from the folder allows to install the requirements running the command</p>

<p><code class="language-plaintext highlighter-rouge">pip install -r requirements.txt</code></p>

<p>Once the requirements are installed we are going to download the 117M using the command</p>

<p><code class="language-plaintext highlighter-rouge">python download_model.py 117m</code></p>

<p>This will create a folder called 117M and we are now ready to train.</p>

<h3 id="training-the-model">Training the Model</h3>

<p>The website I used to find a dataset to train the model is called <a href="https://www.kaggle.com">www.kaggle.com</a>. I used a the dataset called <a href="https://www.kaggle.com/jef1056/anime-subtitles?select=input+%28Cleaned%29.txt"><em>Anime Subtitles</em></a> by Jess Fan. This dataset was already in a text format so it was easier to use with the program.</p>

<p>After getting the data you would like to train the model to you must move it the <code class="language-plaintext highlighter-rouge">.txt</code> file int the <code class="language-plaintext highlighter-rouge">src</code> folder. from here you want to run the terminal from the src folder and run the command</p>

<p><code class="language-plaintext highlighter-rouge">python encode.py "yourdata".txt "yourdata".npz</code></p>

<p>Now we have the dataset ready to train the GPT-2 program.</p>

<h3 id="training-gpt-2">Training GPT-2</h3>

<p>Making sure we are in the same directory as the train.py file we run the terminal from there and run the following command</p>

<p><code class="language-plaintext highlighter-rouge">python train.py --dataset "yourdata.npz"</code></p>

<p>Once the command is running you will see the following in the terminal which means the program is training.</p>

<p><img src="\assets\img\anime-text-generator\ex0-training.png" alt="Training" /></p>

<p>Pressing the <code class="language-plaintext highlighter-rouge">Ctrl+C</code> will stop the training and create the model needed to generate samples.</p>

<h3 id="generating-conditional-samples">Generating Conditional Samples</h3>

<p>The first thing yo want to do is go into the <code class="language-plaintext highlighter-rouge">src/models</code> folder and create a new folder. Name it whatever you would like. 
Now, copy the following files from the <code class="language-plaintext highlighter-rouge">src/checkpoint/run1</code> folder</p>

<ul>
  <li>checkpoint</li>
  <li>model-xxx.data-00000-of-00001</li>
  <li>model-xxx.index</li>
  <li>model-xxx.meta</li>
</ul>

<p>the xxx refer to the number of steps since we can stop the training whenever we would like.</p>

<p>Next you would want to paste them into the folder that was recently created. After pasting those files go to the 117M folder and copy the files</p>

<ul>
  <li>encoder.json</li>
  <li>hparams.json</li>
  <li>vocab.bpe</li>
</ul>

<p>Paste them into the folder that was created. Once you have all seven files in the folder we can now generate the samples.</p>

<p>Finally run the following command in the ternimal replacing “foldername” with the name of the folder that was created.</p>

<p><code class="language-plaintext highlighter-rouge">python interactive_conditional_samples.py --temperature 0.8 --top_k 40 --model_name "foldername"</code></p>

<p>The program will ask for input after running, this is when you can input a string of text giving the program context like.</p>

<h3 id="personal-examples">Personal Examples</h3>

<p>UItilizing the <a href="https://github.com/nshepperd/gpt-2">nshepperd’s</a> repo I trained the GPT-2 program using anime subtitles taken from the <a href="https://www.kaggle.com/jef1056/anime-subtitles?select=input+%28Cleaned%29.txt"><em>Anime Subtitles</em></a> by Jess Fan.</p>

<p>Modifying the program, I attempted to make it more of a chat bot. Training the program with the anime subtitles, the hope was to get some interesting responses similar to someone speaking as though they were from an anime. The results were interesting.</p>

<p>If you would like to take a look at the modified code I made please check my <a href="https://github.com/gperalta102/gpt-2">github</a>.</p>

<h3 id="initial-results">Initial Results</h3>
<p>the initial result were interesting to say the least. The program had a a problem with repeating itself as seen in the following example.</p>

<p><img src="\assets\img\anime-text-generator\ex1-everything.png" alt="example of repeating output" /></p>

<p>This was probably due to the amount of training that was done. Due to being trained on a 5 year old laptop with a dual-core i5 processor the training was slow. The laptop lacked any GPU to accelerate the process.</p>

<p>After a bit more training the outputs stopped repeating theselves. To make it seem more like a chat bot I limited the lines of output to a couple of sentences. I also modified the program to allow continued input after the program output a response. The following examples are some of the outputs after the program was modified.</p>

<h4 id="the-guy-in-the-basement">The Guy in the Basement</h4>

<p><img src="\assets\img\anime-text-generator\ex3-chat.png" alt="chatting bot" /></p>

<h4 id="tawa-the-programmer">Tawa the programmer</h4>

<p><img src="\assets\img\anime-text-generator\ex4-tawa.png" alt="tawa the programmer" /></p>

<h3 id="conclusion">Conclusion</h3>

<p>While not complicated it is interesting to see how GPT-2 can be used to generate text from almost any source. Using anime subtitles was interesting as it seem to make up scenarios on its own. This does not work well for trying to make it into a form of a chatbot sadly. Maybe a bit more training would help with the progam.</p>



      

      

    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="mailto:gustavoperalta102@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/gperalta102" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://linkedin.com/in/gustavoeperalta" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
      2021

      
        &nbsp;&bull;&nbsp;
        <span class="author-site">
          <a href="https://gusperalta.com/">gusperalta.com</a>
        </span>
      

      
      </p>
      <!-- Please don't remove this, keep my open source work credited :) -->
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
